# **﻿Mountain_Pass_API** - REST API для учёта и модерации горных перевалов.

Федерации Спортивного Туризма России (ФСТР) заказала разработку мобильного приложения для Android и iOS, которое упростит туристам задачу по отправке данных о перевале.
Пользователи мобильного приложения будут вносить данные о перевале, при отправке данных будут вызваться методы REST API, которые в свою очередь будет вносить изменения в базу данных ФСТР для дальнейшей работы.


## На текущем этапе разработки реализовано:
- Создание базы данных PostgreSQL.
- Создание класса по работе с данными, с помощью которого ты будешь добавлять новые значения в таблицу перевалов.
- Написание REST API, который будет вызывать метод из класса по работе с данными.
- Добавлен метод POST submitData для добавления информации о горном перевале в БД.
- Добавлен метод GET /submitData/<mountain_pass_id> для получения информации о горном перевале по его id.
- Добавлен метод PATCH /submitData/<mountain_pass_id> для редактирования информации о горном перевале по его id.
- Добавлен метод GET /submitData/?user__email=<email> для получения информации о всех горных перевалах, добавленных пользователем <email> в БД.
- Добавлены автотесты с помощью библиотеки pytest для тестирования корректной работы приложения с БД.
- Добавлена документация с помощью Swagger Editor (файл openapi.yaml).
- Настроен workflows для Github Actions для автоматической сборки Docker контейнера и его деплоя на виртуальную машину (VM) Yandex Cloud


## Конфигурация workflows для Github Actions состоит из трех этапов:
    run_tests - запуск автотестов
    build_image_to_yc - сборка образа rest api
    deploy_image_to_yc - деплой образа на виртуальную машину (VM) Yandex Cloud


## Что было сделано для автоматического деплоя проекта:

1. Создан сервисный аккаунт на Yandex Cloud и создана VM.
2. Установлен и настроен docker на VM
3. Настроена база данных
4. Создан Dockerfile приложения
5. Создана конфигурацию workflows для Github Actions с описанием шагов:
    - Вход в аккаунт Yandex Cloud
    - Сборка образа с приложением
    - Вход в аккаунт docker
    - Удаление старого образа и деплой нового
    - Настроены секреты Github

В проекте есть .env файл, его нет в репозитории. Все ключи подтягиваются из раздела Settings -> Secrets -> Actions текущего репозитория
Каждый раз при выполнении push или merge request в ветку main, будет запускаться автодеплой на VM.

## Для запуска проекта необходимо:
1. Убедитесь, что у вас установлен python версии 3.12.
2. Клонируйте этот репозиторий.
3. Создайте venv. Активируйте и установите необходимые зависимости либо с помощью pip, либо poetry.
4. Настройте конфиг (.env). Необходимо указать необходимые настройки (см. файл .env-example)
5. Выполните миграции, выполнив команду: alembic upgrade head
6. Запустите main.py
